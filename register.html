<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Todo App</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        body {
            background: rgba(87, 199, 230, 0.82);
        }

        #container {
            width: 300px;
            margin: 0 auto;
            margin-top: 150px;
        }

        .tabs {
            display: table-cell;
            width: 30%;
            background-color: rgba(11, 177, 224, 0.82);
            padding: 10px;
            float: left;
            text-align: center;
            vertical-align: middle;
            border-bottom: 0px;
            position: relative;
            font-size: 1.3em;
            color: #ffffff;
        }

        .tabs:hover,
        p {
            cursor: pointer;
        }

        #lt {
            background-color: rgb(12, 132, 189);
        }

        #cont {
            width: 100%;
            height: 300px;
        }

        input {
            display: block;
            width: 250px;
            margin: 10px 10px;
            padding: 8px;
            font-size: 1.3em;
            color: rgba(8, 28, 34, 0.82);
            outline: 2px solid #ffffff;
        }

        input[type="submit"] {
            width: 250px;
            color: #6e6e6e;
        }

        #clear {
            clear: both;
        }

        .comm {
            position: absolute;
            visibility: hidden;
        }

        #login {
            visibility: visible;
        }

        h3 {
            display: table-cell;
            vertical-align: middle;
            padding: 10px 15px;
            font-size: 1.5em;
            color: #ffffff;
        }

        #forgot h3 {
            display: block;
            margin-top: 30px;
            text-align: center;
        }

        #forgot div {
            margin-top: 30px;
        }

        p {
            padding: 10px 15px;
            font-size: 1.3em;
            color: #ffffff;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">Todo App</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="./index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Register</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="./profile.html">Profile</a>
                </li>
            </ul>

        </div>
    </nav>


    <div id="container">
        <div id="tabs">
            <p id="lt" class="tabs" onclick="loginTabFunction()">Log in</p>
            <p id="rt" class="tabs" onclick="registerTabFunction()">Register</p>

            <div id="clear"></div>
        </div>


        <div id="cont">
            <div id="login" class="comm">
                <h3>Sign in</h3>
                <form action="profile.html">
                    <div id="mDIV">
                        <input id="se" type="text" placeholder="Username/Email" required />
                        <input id="sp" type="password" placeholder="Password" required />
                        <input type="submit" onclick="login()" value="Submit" />
                    </div>
                </form>
                <p onclick="forgetTabFunction()">Forget Password?</p>
            </div>
            <div id="register" class="comm">
                <h3>Register</h3>
                <form name='registration'>

                    <input id="re" type="email" placeholder="Email" required />
                    <input id="rf" type="text" placeholder="FirstName" required />
                    <input id="rl" type="text" placeholder="LastName" required />
                    <input id="rg" type="text" placeholder="Gender" required />
                    <input id="ra" type="text" placeholder="Address" required />
                    <input id="rp" type="password" placeholder="Password" required />
                    <input id="rrp" type="password" placeholder="Re write Password" required />
                    <input id="rd" type="file" />
                    <input type="submit" onclick="register()" value="Submit" />

                </form>
            </div>
            <div id="forgot" class="comm">
                <h3>Forgot Password</h3>
                <form>
                    <input id="fe" type="email" placeholder="Email" required />
                    <input type="submit" onclick="forgot()" value="Submit" />
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

    <script>

        var loginBox = document.getElementById("login");
        var regBox = document.getElementById("register");
        var forgetBox = document.getElementById("forgot");

        var loginTab = document.getElementById("lt");
        var regTab = document.getElementById("rt");

        function registerTabFunction() {
            event.preventDefault();

            regBox.style.visibility = "visible";
            loginBox.style.visibility = "hidden";
            forgetBox.style.visibility = "hidden";

            regTab.style.backgroundColor = "rgb(12, 132, 189)";
            loginTab.style.backgroundColor = "rgba(11, 177, 224, 0.82)";
        }
        function loginTabFunction() {
            event.preventDefault();

            regBox.style.visibility = "hidden";
            loginBox.style.visibility = "visible";
            forgetBox.style.visibility = "hidden";

            loginTab.style.backgroundColor = "rgb(12, 132, 189)";
            regTab.style.backgroundColor = "rgba(11, 177, 224, 0.82)";
        }
        function forgetTabFunction() {
            event.preventDefault();

            regBox.style.visibility = "hidden";
            loginBox.style.visibility = "hidden";
            forgetBox.style.visibility = "visible";

            regTab.style.backgroundColor = "rgba(11, 177, 224, 0.82)";
            loginTab.style.backgroundColor = "rgba(11, 177, 224, 0.82)";

        }


        function register() {
            event.preventDefault();

            var email = document.getElementById("re").value;
            var firstname = document.getElementById("rf").value;
            var lastname = document.getElementById("rl").value;
            var gender = document.getElementById("rg").value;
            var address = document.getElementById("ra").value;
            var password = document.getElementById("rp").value;
            var passwordRetype = document.getElementById("rrp").value;
            const person = { Email: email, firstName: firstname, lastName: lastname, Gender: gender, Address: address, Password: password };

            document.querySelector("#rd").addEventListener("change", function () {
                const reader = new FileReader();
                reader.addEventListener("load", () => {
                    sessionStorage.setItem("CurrentLoggedInPersonPhoto", reader.result);
                });

                reader.readAsDataURL(this.files[0]);
            });
            console.log(person);

            if (password != passwordRetype) {
                alert("Password don't match retype your Password.");
                return;
            }

            if (ValidateEmail(email)) {
                if (passwordValidation(password, 8, 12)) {
                    if (allLetter(firstname) && allLetter(lastname)) {
                        if (genderValidation(gender)) {
                            if (sessionStorage.getItem(email) == null) {
                                sessionStorage.setItem(email, JSON.stringify(person));
                                // window.location.reload()
                                alert(email + "  Thanks for registration. \nTry to login Now");
                            }
                            else {
                                alert(email + " is already register.");
                                return;
                            }
                        }
                    }
                }
            }
            return false;
        }

        function passwordValidation(password, mx, my) {
            var password_len = password.length;
            if (password_len == 0 || password_len >= my || password_len < mx) {
                alert("Password should not be empty / length be between " + mx + " to " + my);
                password.focus();
                return false;
            }
            return true;
        }

        function allLetter(name) {
            var letters = /^[A-Za-z]+$/;
            if (name.match(letters)) {
                return true;
            }
            else {
                alert('Username must have alphabet characters only');
                name.focus();
                return false;
            }
        }

        function ValidateEmail(email) {
            var mailformat = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if (email.match(mailformat)) {
                return true;
            }
            else {
                alert("You have entered an invalid email address!");
                email.focus();
                return false;
            }
        }

        function genderValidation(gender) {

            if (gender == 'Male' || gender == 'male' || gender == 'Female' || gender == 'female') {
                return true;
            }
            else {
                alert('Enter Male/Female');
                gender.focus();
                return false;
            }
        }

        function login() {
            event.preventDefault();

            var email = document.getElementById("se").value;
            var password = document.getElementById("sp").value;

            const person = JSON.parse(sessionStorage.getItem(email));

            if (sessionStorage.getItem(email) == null) {
                if (email == "") {
                    alert("Email required.");
                    return;
                }
                alert("Email does not exist.");
                return;
            }
            else if (person.Password != password) {
                if (password == "") {
                    alert("Password required.");
                    return;
                }
                alert("Password does not match.");
                return;
            }
            else {
                sessionStorage.setItem("CurrentLoggedInPerson", JSON.stringify(person));
                alert(email + " yor are login Now \n welcome to our website.");
                window.location.href = "./profile.html";
                document.getElementById("se").value = "";
                document.getElementById("sp").value = "";
                return;
            }
        }



        function forgot() {
            event.preventDefault();

            var email = document.getElementById("fe").value;

            if (sessionStorage.getItem(email) == null) {
                if (email == "") {
                    alert("Email required.");
                    return;
                }
                alert("Email does not exist.");
                return;
            }

            alert("email is send to your email check it in 24hr. \n Thanks");
            document.getElementById("fe").value = "";
        }

    </script>
</body>

</html>